import{a as zt,R as ve,r as I,g as Ut}from"../react-dom-ZcwTowb8.js";import{j as Kt,V as S,k as rt,l as at,m as Yt,n as Ft,o as Bt,p as Vt,q as Ht,E as Wt,r as W,s as X,Q as Be,P as ie,O as se,t as Ve,c as N,u as Xt,T as He,v as Te}from"../three-bg6CVoAY.js";import{u as F,a as we,b as Zt}from"./fiber-D3qvGV6n.js";var We={},Xe=zt;We.createRoot=Xe.createRoot,We.hydrateRoot=Xe.hydrateRoot;function le(){return le=Object.assign?Object.assign.bind():function(o){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)({}).hasOwnProperty.call(n,t)&&(o[t]=n[t])}return o},le.apply(null,arguments)}function Gt(o,e,n){return Math.max(e,Math.min(o,n))}const O={toVector(o,e){return o===void 0&&(o=e),Array.isArray(o)?o:[o,o]},add(o,e){return[o[0]+e[0],o[1]+e[1]]},sub(o,e){return[o[0]-e[0],o[1]-e[1]]},addTo(o,e){o[0]+=e[0],o[1]+=e[1]},subTo(o,e){o[0]-=e[0],o[1]-=e[1]}};function Ze(o,e,n){return e===0||Math.abs(e)===1/0?Math.pow(o,n*5):o*e*n/(e+n*o)}function Ge(o,e,n,t=.15){return t===0?Gt(o,e,n):o<e?-Ze(e-o,n-e,t)+e:o>n?+Ze(o-n,n-e,t)+n:o}function qt(o,[e,n],[t,s]){const[[c,f],[a,u]]=o;return[Ge(e,c,f,t),Ge(n,a,u,s)]}function $t(o,e){if(typeof o!="object"||o===null)return o;var n=o[Symbol.toPrimitive];if(n!==void 0){var t=n.call(o,e||"default");if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Qt(o){var e=$t(o,"string");return typeof e=="symbol"?e:String(e)}function D(o,e,n){return e=Qt(e),e in o?Object.defineProperty(o,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[e]=n,o}function qe(o,e){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);e&&(t=t.filter(function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable})),n.push.apply(n,t)}return n}function _(o){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qe(Object(n),!0).forEach(function(t){D(o,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}const ct={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function $e(o){return o?o[0].toUpperCase()+o.slice(1):""}const Jt=["enter","leave"];function en(o=!1,e){return o&&!Jt.includes(e)}function tn(o,e="",n=!1){const t=ct[o],s=t&&t[e]||e;return"on"+$e(o)+$e(s)+(en(n,s)?"Capture":"")}const nn=["gotpointercapture","lostpointercapture"];function on(o){let e=o.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const t=nn.includes(e)?"capturecapture":"capture",s=!!~e.indexOf(t);return s&&(e=e.replace("capture","")),{device:e,capture:s,passive:n}}function sn(o,e=""){const n=ct[o],t=n&&n[e]||e;return o+t}function fe(o){return"touches"in o}function lt(o){return fe(o)?"touch":"pointerType"in o?o.pointerType:"mouse"}function rn(o){return Array.from(o.touches).filter(e=>{var n,t;return e.target===o.currentTarget||((n=o.currentTarget)===null||n===void 0||(t=n.contains)===null||t===void 0?void 0:t.call(n,e.target))})}function an(o){return o.type==="touchend"||o.type==="touchcancel"?o.changedTouches:o.targetTouches}function ut(o){return fe(o)?an(o)[0]:o}function cn(o){return rn(o).map(e=>e.identifier)}function ye(o){const e=ut(o);return fe(o)?e.identifier:e.pointerId}function Qe(o){const e=ut(o);return[e.clientX,e.clientY]}function ln(o){const e={};if("buttons"in o&&(e.buttons=o.buttons),"shiftKey"in o){const{shiftKey:n,altKey:t,metaKey:s,ctrlKey:c}=o;Object.assign(e,{shiftKey:n,altKey:t,metaKey:s,ctrlKey:c})}return e}function ue(o,...e){return typeof o=="function"?o(...e):o}function un(){}function fn(...o){return o.length===0?un:o.length===1?o[0]:function(){let e;for(const n of o)e=n.apply(this,arguments)||e;return e}}function Je(o,e){return Object.assign({},e,o||{})}const hn=32;class pn{constructor(e,n,t){this.ctrl=e,this.args=n,this.key=t,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:t,args:s}=this;n[t]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=s,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,t=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=t.from?ue(t.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:t,shared:s}=this;n.args=this.args;let c=0;if(e&&(n.event=e,t.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,ln(e)),s.down=s.pressed=s.buttons%2===1||s.touches>0,c=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const g=n._delta.map(Math.abs);O.addTo(n._distance,g)}this.axisIntent&&this.axisIntent(e);const[f,a]=n._movement,[u,m]=t.threshold,{_step:l,values:d}=n;if(t.hasCustomTransform?(l[0]===!1&&(l[0]=Math.abs(f)>=u&&d[0]),l[1]===!1&&(l[1]=Math.abs(a)>=m&&d[1])):(l[0]===!1&&(l[0]=Math.abs(f)>=u&&Math.sign(f)*u),l[1]===!1&&(l[1]=Math.abs(a)>=m&&Math.sign(a)*m)),n.intentional=l[0]!==!1||l[1]!==!1,!n.intentional)return;const y=[0,0];if(t.hasCustomTransform){const[g,V]=d;y[0]=l[0]!==!1?g-l[0]:0,y[1]=l[1]!==!1?V-l[1]:0}else y[0]=l[0]!==!1?f-l[0]:0,y[1]=l[1]!==!1?a-l[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(y);const w=n.offset,P=n._active&&!n._blocked||n.active;P&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=s[this.ingKey]=n._active,e&&(n.first&&("bounds"in t&&(n._bounds=ue(t.bounds,n)),this.setup&&this.setup()),n.movement=y,this.computeOffset()));const[x,A]=n.offset,[[M,L],[R,k]]=n._bounds;n.overflow=[x<M?-1:x>L?1:0,A<R?-1:A>k?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const E=n._active?t.rubberband||[0,0]:[0,0];if(n.offset=qt(n._bounds,n.offset,E),n.delta=O.sub(n.offset,w),this.computeMovement(),P&&(!n.last||c>hn)){n.delta=O.sub(n.offset,w);const g=n.delta.map(Math.abs);O.addTo(n.distance,g),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&c>0&&(n.velocity=[g[0]/c,g[1]/c],n.timeDelta=c)}}emit(){const e=this.state,n=this.shared,t=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!t.triggerAllEvents)return;const s=this.handler(_(_(_({},n),e),{},{[this.aliasKey]:e.values}));s!==void 0&&(e.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function dn([o,e],n){const t=Math.abs(o),s=Math.abs(e);if(t>s&&t>n)return"x";if(s>t&&s>n)return"y"}class mn extends pn{constructor(...e){super(...e),D(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=O.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=O.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,t=this.config;if(!n.axis&&e){const s=typeof t.axisThreshold=="object"?t.axisThreshold[lt(e)]:t.axisThreshold;n.axis=dn(n._movement,s)}n._blocked=(t.lockDirection||!!t.axis)&&!n.axis||!!t.axis&&t.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const gn=o=>o,et=.15,ft={enabled(o=!0){return o},eventOptions(o,e,n){return _(_({},n.shared.eventOptions),o)},preventDefault(o=!1){return o},triggerAllEvents(o=!1){return o},rubberband(o=0){switch(o){case!0:return[et,et];case!1:return[0,0];default:return O.toVector(o)}},from(o){if(typeof o=="function")return o;if(o!=null)return O.toVector(o)},transform(o,e,n){const t=o||n.shared.transform;return this.hasCustomTransform=!!t,t||gn},threshold(o){return O.toVector(o,0)}},bn=0,J=_(_({},ft),{},{axis(o,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(o=bn){return o},bounds(o={}){if(typeof o=="function")return c=>J.bounds(o(c));if("current"in o)return()=>o.current;if(typeof HTMLElement=="function"&&o instanceof HTMLElement)return o;const{left:e=-1/0,right:n=1/0,top:t=-1/0,bottom:s=1/0}=o;return[[e,n],[t,s]]}}),tt={ArrowRight:(o,e=1)=>[o*e,0],ArrowLeft:(o,e=1)=>[-1*o*e,0],ArrowUp:(o,e=1)=>[0,-1*o*e],ArrowDown:(o,e=1)=>[0,o*e]};class vn extends mn{constructor(...e){super(...e),D(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const n=e._bounds.getBoundingClientRect(),t=e.currentTarget.getBoundingClientRect(),s={left:n.left-t.left+e.offset[0],right:n.right-t.right+e.offset[0],top:n.top-t.top+e.offset[1],bottom:n.bottom-t.bottom+e.offset[1]};e._bounds=J.bounds(s)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const n=this.config,t=this.state;if(e.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(e.buttons):n.pointerButtons!==-1&&n.pointerButtons!==e.buttons))return;const s=this.ctrl.setEventIds(e);n.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(s&&s.size>1&&t._pointerActive)&&(this.start(e),this.setupPointer(e),t._pointerId=ye(e),t._pointerActive=!0,this.computeValues(Qe(e)),this.computeInitial(),n.preventScrollAxis&&lt(e)!=="mouse"?(t._active=!1,this.setupScrollPrevention(e)):n.delay>0?(this.setupDelayTrigger(e),n.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const n=this.state,t=this.config;if(!n._pointerActive)return;const s=ye(e);if(n._pointerId!==void 0&&s!==n._pointerId)return;const c=Qe(e);if(document.pointerLockElement===e.target?n._delta=[e.movementX,e.movementY]:(n._delta=O.sub(c,n._values),this.computeValues(c)),O.addTo(n._movement,n._delta),this.compute(e),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(e);return}if(t.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===t.preventScrollAxis||t.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const n=this.state,t=this.config;if(!n._active||!n._pointerActive)return;const s=ye(e);if(n._pointerId!==void 0&&s!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[c,f]=n._distance;if(n.tap=c<=t.tapsThreshold&&f<=t.tapsThreshold,n.tap&&t.filterTaps)n._force=!0;else{const[a,u]=n._delta,[m,l]=n._movement,[d,y]=t.swipe.velocity,[w,P]=t.swipe.distance,x=t.swipe.duration;if(n.elapsedTime<x){const A=Math.abs(a/n.timeDelta),M=Math.abs(u/n.timeDelta);A>d&&Math.abs(m)>w&&(n.swipe[0]=Math.sign(a)),M>y&&Math.abs(l)>P&&(n.swipe[1]=Math.sign(u))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const n=this.config,t=n.device;n.pointerLock&&e.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,t,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,t,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,yn(e);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const n=tt[e.key];if(n){const t=this.state,s=e.shiftKey?10:e.altKey?.1:1;this.start(e),t._delta=n(this.config.keyboardDisplacement,s),t._keyboardActive=!0,O.addTo(t._movement,t._delta),this.compute(e),this.emit()}}keyUp(e){e.key in tt&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const n=this.config.device;e(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(n,"change",this.pointerMove.bind(this)),e(n,"end",this.pointerUp.bind(this)),e(n,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function yn(o){"persist"in o&&typeof o.persist=="function"&&o.persist()}const ee=typeof window<"u"&&window.document&&window.document.createElement;function ht(){return ee&&"ontouchstart"in window}function En(){return ht()||ee&&window.navigator.maxTouchPoints>1}function _n(){return ee&&"onpointerdown"in window}function Tn(){return ee&&"exitPointerLock"in window.document}function wn(){try{return"constructor"in GestureEvent}catch{return!1}}const C={isBrowser:ee,gesture:wn(),touch:ht(),touchscreen:En(),pointer:_n(),pointerLock:Tn()},Pn=250,On=180,Sn=.5,xn=50,An=250,Dn=10,nt={mouse:0,touch:0,pen:8},Mn=_(_({},J),{},{device(o,e,{pointer:{touch:n=!1,lock:t=!1,mouse:s=!1}={}}){return this.pointerLock=t&&C.pointerLock,C.touch&&n?"touch":this.pointerLock?"mouse":C.pointer&&!s?"pointer":C.touch?"touch":"mouse"},preventScrollAxis(o,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&o?Pn:void 0,!(!C.touchscreen||n===!1))return o||(n!==void 0?"y":void 0)},pointerCapture(o,e,{pointer:{capture:n=!0,buttons:t=1,keys:s=!0}={}}){return this.pointerButtons=t,this.keys=s,!this.pointerLock&&this.device==="pointer"&&n},threshold(o,e,{filterTaps:n=!1,tapsThreshold:t=3,axis:s=void 0}){const c=O.toVector(o,n?t:s?1:0);return this.filterTaps=n,this.tapsThreshold=t,c},swipe({velocity:o=Sn,distance:e=xn,duration:n=An}={}){return{velocity:this.transform(O.toVector(o)),distance:this.transform(O.toVector(e)),duration:n}},delay(o=0){switch(o){case!0:return On;case!1:return 0;default:return o}},axisThreshold(o){return o?_(_({},nt),o):nt},keyboardDisplacement(o=Dn){return o}});_(_({},ft),{},{device(o,e,{shared:n,pointer:{touch:t=!1}={}}){if(n.target&&!C.touch&&C.gesture)return"gesture";if(C.touch&&t)return"touch";if(C.touchscreen){if(C.pointer)return"pointer";if(C.touch)return"touch"}},bounds(o,e,{scaleBounds:n={},angleBounds:t={}}){const s=f=>{const a=Je(ue(n,f),{min:-1/0,max:1/0});return[a.min,a.max]},c=f=>{const a=Je(ue(t,f),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof t!="function"?[s(),c()]:f=>[s(f),c(f)]},threshold(o,e,n){return this.lockDirection=n.axis==="lock",O.toVector(o,this.lockDirection?[.1,3]:0)},modifierKey(o){return o===void 0?"ctrlKey":o},pinchOnWheel(o=!0){return o}});_(_({},J),{},{mouseOnly:(o=!0)=>o});_(_({},J),{},{mouseOnly:(o=!0)=>o});const pt=new Map,_e=new Map;function In(o){pt.set(o.key,o.engine),_e.set(o.key,o.resolver)}const kn={key:"drag",engine:vn,resolver:Mn};function Cn(o,e){if(o==null)return{};var n={},t=Object.keys(o),s,c;for(c=0;c<t.length;c++)s=t[c],!(e.indexOf(s)>=0)&&(n[s]=o[s]);return n}function Ln(o,e){if(o==null)return{};var n=Cn(o,e),t,s;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(o);for(s=0;s<c.length;s++)t=c[s],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(o,t)&&(n[t]=o[t])}return n}const Rn={target(o){if(o)return()=>"current"in o?o.current:o},enabled(o=!0){return o},window(o=C.isBrowser?window:void 0){return o},eventOptions({passive:o=!0,capture:e=!1}={}){return{passive:o,capture:e}},transform(o){return o}},jn=["target","eventOptions","window","enabled","transform"];function ae(o={},e){const n={};for(const[t,s]of Object.entries(e))switch(typeof s){case"function":n[t]=s.call(n,o[t],t,o);break;case"object":n[t]=ae(o[t],s);break;case"boolean":s&&(n[t]=o[t]);break}return n}function Nn(o,e,n={}){const t=o,{target:s,eventOptions:c,window:f,enabled:a,transform:u}=t,m=Ln(t,jn);if(n.shared=ae({target:s,eventOptions:c,window:f,enabled:a,transform:u},Rn),e){const l=_e.get(e);n[e]=ae(_({shared:n.shared},m),l)}else for(const l in m){const d=_e.get(l);d&&(n[l]=ae(_({shared:n.shared},m[l]),d))}return n}class dt{constructor(e,n){D(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,t,s,c){const f=this._listeners,a=sn(n,t),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},m=_(_({},u),c);e.addEventListener(a,s,m);const l=()=>{e.removeEventListener(a,s,m),f.delete(l)};return f.add(l),l}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class zn{constructor(){D(this,"_timeouts",new Map)}add(e,n,t=140,...s){this.remove(e),this._timeouts.set(e,window.setTimeout(n,t,...s))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class Un{constructor(e){D(this,"gestures",new Set),D(this,"_targetEventStore",new dt(this)),D(this,"gestureEventStores",{}),D(this,"gestureTimeoutStores",{}),D(this,"handlers",{}),D(this,"config",{}),D(this,"pointerIds",new Set),D(this,"touchIds",new Set),D(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Kn(this,e)}setEventIds(e){if(fe(e))return this.touchIds=new Set(cn(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=Nn(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,t={};let s;if(!(n.target&&(s=n.target(),!s))){if(n.enabled){for(const f of this.gestures){const a=this.config[f],u=ot(t,a.eventOptions,!!s);if(a.enabled){const m=pt.get(f);new m(this,e,f).bind(u)}}const c=ot(t,n.eventOptions,!!s);for(const f in this.nativeHandlers)c(f,"",a=>this.nativeHandlers[f](_(_({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const c in t)t[c]=fn(...t[c]);if(!s)return t;for(const c in t){const{device:f,capture:a,passive:u}=on(c);this._targetEventStore.add(s,f,"",t[c],{capture:a,passive:u})}}}}function Z(o,e){o.gestures.add(e),o.gestureEventStores[e]=new dt(o,e),o.gestureTimeoutStores[e]=new zn}function Kn(o,e){e.drag&&Z(o,"drag"),e.wheel&&Z(o,"wheel"),e.scroll&&Z(o,"scroll"),e.move&&Z(o,"move"),e.pinch&&Z(o,"pinch"),e.hover&&Z(o,"hover")}const ot=(o,e,n)=>(t,s,c,f={},a=!1)=>{var u,m;const l=(u=f.capture)!==null&&u!==void 0?u:e.capture,d=(m=f.passive)!==null&&m!==void 0?m:e.passive;let y=a?t:tn(t,s,l);n&&d&&(y+="Passive"),o[y]=o[y]||[],o[y].push(c)};function Yn(o,e={},n,t){const s=ve.useMemo(()=>new Un(o),[]);if(s.applyHandlers(o,t),s.applyConfig(e,n),ve.useEffect(s.effect.bind(s)),ve.useEffect(()=>s.clean.bind(s),[]),e.target===void 0)return s.bind.bind(s)}function so(o,e){return In(kn),Yn({drag:o},e||{},"drag")}const ro=o=>(e,n,t)=>{const s=t.subscribe;return t.subscribe=(f,a,u)=>{let m=f;if(a){const l=(u==null?void 0:u.equalityFn)||Object.is;let d=f(t.getState());m=y=>{const w=f(y);if(!l(d,w)){const P=d;a(d=w,P)}},u!=null&&u.fireImmediately&&a(d,d)}return s(m)},o(e,n,t)},Fn=parseInt(Kt.replace(/\D+/g,""));var Bn=Object.defineProperty,Vn=(o,e,n)=>e in o?Bn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,mt=(o,e,n)=>(Vn(o,typeof e!="symbol"?e+"":e,n),n);const ce={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new S},up:{value:new S(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${Fn>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},gt=new rt({name:"SkyShader",fragmentShader:ce.fragmentShader,vertexShader:ce.vertexShader,uniforms:at.clone(ce.uniforms),side:Yt,depthWrite:!1});let Pe=class extends Ft{constructor(){super(new Bt(1,1,1),gt)}};mt(Pe,"SkyShader",ce);mt(Pe,"material",gt);var Hn=Object.defineProperty,Wn=(o,e,n)=>e in o?Hn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,h=(o,e,n)=>(Wn(o,typeof e!="symbol"?e+"":e,n),n);const re=new Vt,it=new Ht,Xn=Math.cos(70*(Math.PI/180)),st=(o,e)=>(o%e+e)%e;let Zn=class extends Wt{constructor(e,n){super(),h(this,"object"),h(this,"domElement"),h(this,"enabled",!0),h(this,"target",new S),h(this,"minDistance",0),h(this,"maxDistance",1/0),h(this,"minZoom",0),h(this,"maxZoom",1/0),h(this,"minPolarAngle",0),h(this,"maxPolarAngle",Math.PI),h(this,"minAzimuthAngle",-1/0),h(this,"maxAzimuthAngle",1/0),h(this,"enableDamping",!1),h(this,"dampingFactor",.05),h(this,"enableZoom",!0),h(this,"zoomSpeed",1),h(this,"enableRotate",!0),h(this,"rotateSpeed",1),h(this,"enablePan",!0),h(this,"panSpeed",1),h(this,"screenSpacePanning",!0),h(this,"keyPanSpeed",7),h(this,"zoomToCursor",!1),h(this,"autoRotate",!1),h(this,"autoRotateSpeed",2),h(this,"reverseOrbit",!1),h(this,"reverseHorizontalOrbit",!1),h(this,"reverseVerticalOrbit",!1),h(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),h(this,"mouseButtons",{LEFT:W.ROTATE,MIDDLE:W.DOLLY,RIGHT:W.PAN}),h(this,"touches",{ONE:X.ROTATE,TWO:X.DOLLY_PAN}),h(this,"target0"),h(this,"position0"),h(this,"zoom0"),h(this,"_domElementKeyEvents",null),h(this,"getPolarAngle"),h(this,"getAzimuthalAngle"),h(this,"setPolarAngle"),h(this,"setAzimuthalAngle"),h(this,"getDistance"),h(this,"listenToKeyEvents"),h(this,"stopListenToKeyEvents"),h(this,"saveState"),h(this,"reset"),h(this,"update"),h(this,"connect"),h(this,"dispose"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>l.phi,this.getAzimuthalAngle=()=>l.theta,this.setPolarAngle=i=>{let r=st(i,2*Math.PI),p=l.phi;p<0&&(p+=2*Math.PI),r<0&&(r+=2*Math.PI);let b=Math.abs(r-p);2*Math.PI-b<b&&(r<p?r+=2*Math.PI:p+=2*Math.PI),d.phi=r-p,t.update()},this.setAzimuthalAngle=i=>{let r=st(i,2*Math.PI),p=l.theta;p<0&&(p+=2*Math.PI),r<0&&(r+=2*Math.PI);let b=Math.abs(r-p);2*Math.PI-b<b&&(r<p?r+=2*Math.PI:p+=2*Math.PI),d.theta=r-p,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=i=>{i.addEventListener("keydown",ge),this._domElementKeyEvents=i},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ge),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(s),t.update(),u=a.NONE},this.update=(()=>{const i=new S,r=new S(0,1,0),p=new Be().setFromUnitVectors(e.up,r),b=p.clone().invert(),T=new S,U=new Be,B=2*Math.PI;return function(){const Fe=t.object.position;p.setFromUnitVectors(e.up,r),b.copy(p).invert(),i.copy(Fe).sub(t.target),i.applyQuaternion(p),l.setFromVector3(i),t.autoRotate&&u===a.NONE&&he(_t()),t.enableDamping?(l.theta+=d.theta*t.dampingFactor,l.phi+=d.phi*t.dampingFactor):(l.theta+=d.theta,l.phi+=d.phi);let K=t.minAzimuthAngle,Y=t.maxAzimuthAngle;isFinite(K)&&isFinite(Y)&&(K<-Math.PI?K+=B:K>Math.PI&&(K-=B),Y<-Math.PI?Y+=B:Y>Math.PI&&(Y-=B),K<=Y?l.theta=Math.max(K,Math.min(Y,l.theta)):l.theta=l.theta>(K+Y)/2?Math.max(K,l.theta):Math.min(Y,l.theta)),l.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,l.phi)),l.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(w,t.dampingFactor):t.target.add(w),t.zoomToCursor&&z||t.object.isOrthographicCamera?l.radius=de(l.radius):l.radius=de(l.radius*y),i.setFromSpherical(l),i.applyQuaternion(b),Fe.copy(t.target).add(i),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(d.theta*=1-t.dampingFactor,d.phi*=1-t.dampingFactor,w.multiplyScalar(1-t.dampingFactor)):(d.set(0,0,0),w.set(0,0,0));let q=!1;if(t.zoomToCursor&&z){let $=null;if(t.object instanceof ie&&t.object.isPerspectiveCamera){const Q=i.length();$=de(Q*y);const oe=Q-$;t.object.position.addScaledVector(V,oe),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const Q=new S(j.x,j.y,0);Q.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/y)),t.object.updateProjectionMatrix(),q=!0;const oe=new S(j.x,j.y,0);oe.unproject(t.object),t.object.position.sub(oe).add(Q),t.object.updateMatrixWorld(),$=i.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;$!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar($).add(t.object.position):(re.origin.copy(t.object.position),re.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(re.direction))<Xn?e.lookAt(t.target):(it.setFromNormalAndCoplanarPoint(t.object.up,t.target),re.intersectPlane(it,t.target))))}else t.object instanceof se&&t.object.isOrthographicCamera&&(q=y!==1,q&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/y)),t.object.updateProjectionMatrix()));return y=1,z=!1,q||T.distanceToSquared(t.object.position)>m||8*(1-U.dot(t.object.quaternion))>m?(t.dispatchEvent(s),T.copy(t.object.position),U.copy(t.object.quaternion),q=!1,!0):!1}})(),this.connect=i=>{i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),t.domElement=i,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",Ke),t.domElement.addEventListener("pointerdown",ze),t.domElement.addEventListener("pointercancel",G),t.domElement.addEventListener("wheel",Ue)},this.dispose=()=>{var i,r,p,b,T,U;t.domElement&&(t.domElement.style.touchAction="auto"),(i=t.domElement)==null||i.removeEventListener("contextmenu",Ke),(r=t.domElement)==null||r.removeEventListener("pointerdown",ze),(p=t.domElement)==null||p.removeEventListener("pointercancel",G),(b=t.domElement)==null||b.removeEventListener("wheel",Ue),(T=t.domElement)==null||T.ownerDocument.removeEventListener("pointermove",me),(U=t.domElement)==null||U.ownerDocument.removeEventListener("pointerup",G),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",ge)};const t=this,s={type:"change"},c={type:"start"},f={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let u=a.NONE;const m=1e-6,l=new Ve,d=new Ve;let y=1;const w=new S,P=new N,x=new N,A=new N,M=new N,L=new N,R=new N,k=new N,E=new N,g=new N,V=new S,j=new N;let z=!1;const v=[],te={};function _t(){return 2*Math.PI/60/60*t.autoRotateSpeed}function ne(){return Math.pow(.95,t.zoomSpeed)}function he(i){t.reverseOrbit||t.reverseHorizontalOrbit?d.theta+=i:d.theta-=i}function Oe(i){t.reverseOrbit||t.reverseVerticalOrbit?d.phi+=i:d.phi-=i}const Se=(()=>{const i=new S;return function(p,b){i.setFromMatrixColumn(b,0),i.multiplyScalar(-p),w.add(i)}})(),xe=(()=>{const i=new S;return function(p,b){t.screenSpacePanning===!0?i.setFromMatrixColumn(b,1):(i.setFromMatrixColumn(b,0),i.crossVectors(t.object.up,i)),i.multiplyScalar(p),w.add(i)}})(),H=(()=>{const i=new S;return function(p,b){const T=t.domElement;if(T&&t.object instanceof ie&&t.object.isPerspectiveCamera){const U=t.object.position;i.copy(U).sub(t.target);let B=i.length();B*=Math.tan(t.object.fov/2*Math.PI/180),Se(2*p*B/T.clientHeight,t.object.matrix),xe(2*b*B/T.clientHeight,t.object.matrix)}else T&&t.object instanceof se&&t.object.isOrthographicCamera?(Se(p*(t.object.right-t.object.left)/t.object.zoom/T.clientWidth,t.object.matrix),xe(b*(t.object.top-t.object.bottom)/t.object.zoom/T.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function pe(i){t.object instanceof ie&&t.object.isPerspectiveCamera||t.object instanceof se&&t.object.isOrthographicCamera?y/=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function Ae(i){t.object instanceof ie&&t.object.isPerspectiveCamera||t.object instanceof se&&t.object.isOrthographicCamera?y*=i:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function De(i){if(!t.zoomToCursor||!t.domElement)return;z=!0;const r=t.domElement.getBoundingClientRect(),p=i.clientX-r.left,b=i.clientY-r.top,T=r.width,U=r.height;j.x=p/T*2-1,j.y=-(b/U)*2+1,V.set(j.x,j.y,1).unproject(t.object).sub(t.object.position).normalize()}function de(i){return Math.max(t.minDistance,Math.min(t.maxDistance,i))}function Me(i){P.set(i.clientX,i.clientY)}function Tt(i){De(i),k.set(i.clientX,i.clientY)}function Ie(i){M.set(i.clientX,i.clientY)}function wt(i){x.set(i.clientX,i.clientY),A.subVectors(x,P).multiplyScalar(t.rotateSpeed);const r=t.domElement;r&&(he(2*Math.PI*A.x/r.clientHeight),Oe(2*Math.PI*A.y/r.clientHeight)),P.copy(x),t.update()}function Pt(i){E.set(i.clientX,i.clientY),g.subVectors(E,k),g.y>0?pe(ne()):g.y<0&&Ae(ne()),k.copy(E),t.update()}function Ot(i){L.set(i.clientX,i.clientY),R.subVectors(L,M).multiplyScalar(t.panSpeed),H(R.x,R.y),M.copy(L),t.update()}function St(i){De(i),i.deltaY<0?Ae(ne()):i.deltaY>0&&pe(ne()),t.update()}function xt(i){let r=!1;switch(i.code){case t.keys.UP:H(0,t.keyPanSpeed),r=!0;break;case t.keys.BOTTOM:H(0,-t.keyPanSpeed),r=!0;break;case t.keys.LEFT:H(t.keyPanSpeed,0),r=!0;break;case t.keys.RIGHT:H(-t.keyPanSpeed,0),r=!0;break}r&&(i.preventDefault(),t.update())}function ke(){if(v.length==1)P.set(v[0].pageX,v[0].pageY);else{const i=.5*(v[0].pageX+v[1].pageX),r=.5*(v[0].pageY+v[1].pageY);P.set(i,r)}}function Ce(){if(v.length==1)M.set(v[0].pageX,v[0].pageY);else{const i=.5*(v[0].pageX+v[1].pageX),r=.5*(v[0].pageY+v[1].pageY);M.set(i,r)}}function Le(){const i=v[0].pageX-v[1].pageX,r=v[0].pageY-v[1].pageY,p=Math.sqrt(i*i+r*r);k.set(0,p)}function At(){t.enableZoom&&Le(),t.enablePan&&Ce()}function Dt(){t.enableZoom&&Le(),t.enableRotate&&ke()}function Re(i){if(v.length==1)x.set(i.pageX,i.pageY);else{const p=be(i),b=.5*(i.pageX+p.x),T=.5*(i.pageY+p.y);x.set(b,T)}A.subVectors(x,P).multiplyScalar(t.rotateSpeed);const r=t.domElement;r&&(he(2*Math.PI*A.x/r.clientHeight),Oe(2*Math.PI*A.y/r.clientHeight)),P.copy(x)}function je(i){if(v.length==1)L.set(i.pageX,i.pageY);else{const r=be(i),p=.5*(i.pageX+r.x),b=.5*(i.pageY+r.y);L.set(p,b)}R.subVectors(L,M).multiplyScalar(t.panSpeed),H(R.x,R.y),M.copy(L)}function Ne(i){const r=be(i),p=i.pageX-r.x,b=i.pageY-r.y,T=Math.sqrt(p*p+b*b);E.set(0,T),g.set(0,Math.pow(E.y/k.y,t.zoomSpeed)),pe(g.y),k.copy(E)}function Mt(i){t.enableZoom&&Ne(i),t.enablePan&&je(i)}function It(i){t.enableZoom&&Ne(i),t.enableRotate&&Re(i)}function ze(i){var r,p;t.enabled!==!1&&(v.length===0&&((r=t.domElement)==null||r.ownerDocument.addEventListener("pointermove",me),(p=t.domElement)==null||p.ownerDocument.addEventListener("pointerup",G)),jt(i),i.pointerType==="touch"?Lt(i):kt(i))}function me(i){t.enabled!==!1&&(i.pointerType==="touch"?Rt(i):Ct(i))}function G(i){var r,p,b;Nt(i),v.length===0&&((r=t.domElement)==null||r.releasePointerCapture(i.pointerId),(p=t.domElement)==null||p.ownerDocument.removeEventListener("pointermove",me),(b=t.domElement)==null||b.ownerDocument.removeEventListener("pointerup",G)),t.dispatchEvent(f),u=a.NONE}function kt(i){let r;switch(i.button){case 0:r=t.mouseButtons.LEFT;break;case 1:r=t.mouseButtons.MIDDLE;break;case 2:r=t.mouseButtons.RIGHT;break;default:r=-1}switch(r){case W.DOLLY:if(t.enableZoom===!1)return;Tt(i),u=a.DOLLY;break;case W.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(t.enablePan===!1)return;Ie(i),u=a.PAN}else{if(t.enableRotate===!1)return;Me(i),u=a.ROTATE}break;case W.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(t.enableRotate===!1)return;Me(i),u=a.ROTATE}else{if(t.enablePan===!1)return;Ie(i),u=a.PAN}break;default:u=a.NONE}u!==a.NONE&&t.dispatchEvent(c)}function Ct(i){if(t.enabled!==!1)switch(u){case a.ROTATE:if(t.enableRotate===!1)return;wt(i);break;case a.DOLLY:if(t.enableZoom===!1)return;Pt(i);break;case a.PAN:if(t.enablePan===!1)return;Ot(i);break}}function Ue(i){t.enabled===!1||t.enableZoom===!1||u!==a.NONE&&u!==a.ROTATE||(i.preventDefault(),t.dispatchEvent(c),St(i),t.dispatchEvent(f))}function ge(i){t.enabled===!1||t.enablePan===!1||xt(i)}function Lt(i){switch(Ye(i),v.length){case 1:switch(t.touches.ONE){case X.ROTATE:if(t.enableRotate===!1)return;ke(),u=a.TOUCH_ROTATE;break;case X.PAN:if(t.enablePan===!1)return;Ce(),u=a.TOUCH_PAN;break;default:u=a.NONE}break;case 2:switch(t.touches.TWO){case X.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;At(),u=a.TOUCH_DOLLY_PAN;break;case X.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Dt(),u=a.TOUCH_DOLLY_ROTATE;break;default:u=a.NONE}break;default:u=a.NONE}u!==a.NONE&&t.dispatchEvent(c)}function Rt(i){switch(Ye(i),u){case a.TOUCH_ROTATE:if(t.enableRotate===!1)return;Re(i),t.update();break;case a.TOUCH_PAN:if(t.enablePan===!1)return;je(i),t.update();break;case a.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;Mt(i),t.update();break;case a.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;It(i),t.update();break;default:u=a.NONE}}function Ke(i){t.enabled!==!1&&i.preventDefault()}function jt(i){v.push(i)}function Nt(i){delete te[i.pointerId];for(let r=0;r<v.length;r++)if(v[r].pointerId==i.pointerId){v.splice(r,1);return}}function Ye(i){let r=te[i.pointerId];r===void 0&&(r=new N,te[i.pointerId]=r),r.set(i.pageX,i.pageY)}function be(i){const r=i.pointerId===v[0].pointerId?v[1]:v[0];return te[r.pointerId]}n!==void 0&&this.connect(n),this.update()}};function lo(o,e){if(Object.is(o,e))return!0;if(typeof o!="object"||o===null||typeof e!="object"||e===null)return!1;const n=Object.keys(o);if(n.length!==Object.keys(e).length)return!1;for(let t=0;t<n.length;t++)if(!Object.prototype.hasOwnProperty.call(e,n[t])||!Object.is(o[n[t]],e[n[t]]))return!1;return!0}function fo(o,e,n,t){const s=class extends rt{constructor(f={}){const a=Object.entries(o);super({uniforms:a.reduce((u,[m,l])=>{const d=at.clone({[m]:{value:l}});return{...u,...d}},{}),vertexShader:e,fragmentShader:n}),this.key="",a.forEach(([u])=>Object.defineProperty(this,u,{get:()=>this.uniforms[u].value,set:m=>this.uniforms[u].value=m})),Object.assign(this,f)}};return s.key=Xt.generateUUID(),s}const Ee=o=>o===Object(o)&&!Array.isArray(o)&&typeof o!="function";function bt(o,e){const n=F(c=>c.gl),t=we(Te,Ee(o)?Object.values(o):o);return I.useLayoutEffect(()=>{e==null||e(t)},[e]),I.useEffect(()=>{if("initTexture"in n){let c=[];Array.isArray(t)?c=t:t instanceof He?c=[t]:Ee(t)&&(c=Object.values(t)),c.forEach(f=>{f instanceof He&&n.initTexture(f)})}},[n,t]),I.useMemo(()=>{if(Ee(o)){const c={};let f=0;for(const a in o)c[a]=t[f++];return c}else return t},[o,t])}bt.preload=o=>we.preload(Te,o);bt.clear=o=>we.clear(Te,o);const ho=I.forwardRef(({makeDefault:o,camera:e,regress:n,domElement:t,enableDamping:s=!0,keyEvents:c=!1,onChange:f,onStart:a,onEnd:u,...m},l)=>{const d=F(g=>g.invalidate),y=F(g=>g.camera),w=F(g=>g.gl),P=F(g=>g.events),x=F(g=>g.setEvents),A=F(g=>g.set),M=F(g=>g.get),L=F(g=>g.performance),R=e||y,k=t||P.connected||w.domElement,E=I.useMemo(()=>new Zn(R),[R]);return Zt(()=>{E.enabled&&E.update()},-1),I.useEffect(()=>(c&&E.connect(c===!0?k:c),E.connect(k),()=>void E.dispose()),[c,k,n,E,d]),I.useEffect(()=>{const g=z=>{d(),n&&L.regress(),f&&f(z)},V=z=>{a&&a(z)},j=z=>{u&&u(z)};return E.addEventListener("change",g),E.addEventListener("start",V),E.addEventListener("end",j),()=>{E.removeEventListener("start",V),E.removeEventListener("end",j),E.removeEventListener("change",g)}},[f,a,u,E,d,x]),I.useEffect(()=>{if(o){const g=M().controls;return A({controls:E}),()=>A({controls:g})}},[o,E]),I.createElement("primitive",le({ref:l,object:E,enableDamping:s},m))});var vt={exports:{}},Gn="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",qn=Gn,$n=qn;function yt(){}function Et(){}Et.resetWarningCache=yt;var Qn=function(){function o(t,s,c,f,a,u){if(u!==$n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}o.isRequired=o;function e(){return o}var n={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:e,element:o,elementType:o,instanceOf:e,node:o,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Et,resetWarningCache:yt};return n.PropTypes=n,n};vt.exports=Qn();var Jn=vt.exports;const po=Ut(Jn);function eo(o,e,n=new S){const t=Math.PI*(o-.5),s=2*Math.PI*(e-.5);return n.x=Math.cos(s),n.y=Math.sin(t),n.z=Math.sin(s),n}const mo=I.forwardRef(({inclination:o=.6,azimuth:e=.1,distance:n=1e3,mieCoefficient:t=.005,mieDirectionalG:s=.8,rayleigh:c=.5,turbidity:f=10,sunPosition:a=eo(o,e),...u},m)=>{const l=I.useMemo(()=>new S().setScalar(n),[n]),[d]=I.useState(()=>new Pe);return I.createElement("primitive",le({object:d,ref:m,"material-uniforms-mieCoefficient-value":t,"material-uniforms-mieDirectionalG-value":s,"material-uniforms-rayleigh-value":c,"material-uniforms-sunPosition-value":a,"material-uniforms-turbidity-value":f,scale:l},u))});export{ho as O,po as P,mo as S,le as _,ro as a,fo as b,bt as c,We as d,lo as s,so as u};
